FROM node:16-alpine3.14

WORKDIR /usr/src/app

COPY . .

RUN npm install

RUN npm run build

RUN npm run api-docs

ARG DATABASE_URL
ARG DATABASE_NAME
ARG REDIS_URL

ENV DATABASE_URL=$DATABASE_URL
ENV DATABASE_NAME=$DATABASE_NAME
ENV REDIS_URL=$REDIS_URL

EXPOSE 4000

CMD ["node", "dist/server.js"]
